{% extends 'bbs/layout.html' %}
{% load sekizai_tags %}

{% block content %}

{% addtoblock "css" %}
    <link rel="stylesheet" href="{{ STATIC_URL }}lib/leaflet/leaflet.css" />
    <link rel="stylesheet" href="{{ STATIC_URL }}lib/social/social.css" />
    <link rel="stylesheet" href="{{ STATIC_URL }}map.css" />
{% endaddtoblock %}

{% addtoblock "js" %}
    <script type="text/javascript" src="{{ STATIC_URL }}lib/leaflet/leaflet.js" ></script>
    <script type="text/javascript" src="{{ STATIC_URL }}lib/social/social.js" ></script>
    <script type="text/javascript" src="{{ STATIC_URL }}map.js" ></script>
    <script type="text/javascript">
        var siteUrl = '{{ siteUrl|safe }}';
        var staticUrl = '{{ STATIC_URL }}';

        var verfahren = {};
        {% for v in verfahren %}
        verfahren[{{v.pk}}] = {"pk": {{v.pk}}, "name": "{{v.name}}"};
        {% endfor %}

        var verfahrensschritte = {};
        {% for v in verfahrensschritte %}
        verfahrensschritte[{{v.pk}}] = {"pk": {{v.pk}}, "name": "{{v.name}}", "icon": "{{v.icon}}", "hoverIcon": "{{v.hoverIcon}}"};
        {% endfor %}

        var points = {}
        {% for v in veroeffentlichungen %}
        points[{{v.pk}}] = {"pk": {{v.pk}}, "ende": "{{v.ende}}", "behoerde": "{{v.behoerde.name}}", "projekt": {{v.projekt.pk}}, "adresse": "{{v.projekt.adresse}}", "lat": {{v.projekt.lat|stringformat:"F"}}, "lon": {{v.projekt.lon|stringformat:"F"}}, "vspk": {{v.verfahrensschritt.pk}}, "vpk": {{v.verfahrensschritt.verfahren.pk}} };
        {% endfor %}
        
        var pointsOld = {}
        {% for v in veroeffentlichungenAlt %}
        pointsOld[{{v.pk}}] = {"pk": {{v.pk}}, "ende": "{{v.ende}}", "behoerde": "{{v.behoerde.name}}", "projekt": {{v.projekt.pk}}, "adresse": "{{v.projekt.adresse}}", "lat": {{v.projekt.lat|stringformat:"F"}}, "lon": {{v.projekt.lon|stringformat:"F"}}, "vspk": {{v.verfahrensschritt.pk}}, "vpk": {{v.verfahrensschritt.verfahren.pk}} };
        {% endfor %}
    </script>
{% endaddtoblock %}

<div id="wrapper" class="absolute">
    <div class="container" >
        <div id="buttons-left"></div>
        <div id="buttons-right"></div>
    </div>
    <div id="map"></div>
</div>

<div id="footer" class="absolute">
    <div class="container">
        <div id="footer-left" class="visible-md visible-lg">
            <label class="checkbox" class="checkbox">
                <input type="checkbox" name="old"> Veröffentlichungen mit abgelaufener Frist anzeigen
            </label>
            <div id="social">
                <div id="facebook"></div>
                <div id="twitter"></div>
                <div id="gplus"></div>
            </div>
        </div>                                            
        <div id="footer-right" class="attribution">                
            Powered by <a href="http://leaflet.cloudmade.com">Leaflet</a>
            Map data © 2012 OpenStreetMap contributors
        </div>
    </div>
</div>
{% endblock %}
